<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <link rel="canonical" href="https://osg-htc.org/user-school-2019/materials/day1/part4-ex2-login-scp/">
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Exercise 4.2 - OSG User School 2019</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <link href="../../../css/extra.css" rel="stylesheet">
    <link href="../../../css/codehilite.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Monday Exercise 4.2: Log in to the OSG Submit Machine", url: "#_top", children: [
              {title: "Log in to the OSG submit machine", url: "#log-in-to-the-osg-submit-machine" },
              {title: "Preparing files for transfer", url: "#preparing-files-for-transfer" },
              {title: "Transferring files", url: "#transferring-files" },
              {title: "Next exercise", url: "#next-exercise" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    <h1 id="monday-exercise-42-log-in-to-the-osg-submit-machine">Monday Exercise 4.2: Log in to the OSG Submit Machine<a class="headerlink" href="#monday-exercise-42-log-in-to-the-osg-submit-machine" title="Permanent link">&para;</a></h1>
<p>The goal of this exercise is to log in to a different submit host so that you can start submitting jobs into the OSG
instead of the local cluster here at UW-Madison.
Additionally, you will learn about the <code>tar</code> and <code>scp</code> commands, which will allow you to efficiently copy files between
the two submit nodes.</p>
<p>If you have trouble getting <code>ssh</code> access to the submit machine, ask the instructors right away! Gaining access is
critical for all remaining exercises.</p>
<h2 id="log-in-to-the-osg-submit-machine">Log in to the OSG submit machine<a class="headerlink" href="#log-in-to-the-osg-submit-machine" title="Permanent link">&para;</a></h2>
<p>For some of the remaining exercises today, you will be using a machine named <code>training.osgconnect.net</code>.
The username and password are listed on your 'Accounts' paper that you received yesterday.
If you no longer have it, please ask the instructors for help.</p>
<p>Once you have your account details, <code>ssh</code> in to the machine and take a look around.</p>
<div class="admonition note">
<p class="admonition-title">IMPORTANT</p>
<p>For performance reasons, you will be doing all of your work on <code>training.osgconnect.net</code> out of
your local scratch directory, <code>/local-scratch/&lt;USERNAME&gt;/</code> replacing <code>&lt;USERNAME&gt;</code> with your own username.</p>
<p>Do <strong>NOT</strong> use your home directory for job submission.</p>
</div>
<h2 id="preparing-files-for-transfer">Preparing files for transfer<a class="headerlink" href="#preparing-files-for-transfer" title="Permanent link">&para;</a></h2>
<p>When transferring files between computers, it's best to limit the number of files as well as their size.
Smaller files transfer more quickly and if your network connection drops, restarting the transfer is less painful than
it would be if you were transferring large files.</p>
<p>Archiving tools (WinZip, 7zip, Archive Utility, etc.) can compress the size of your files and place them into a single,
smaller archive file.
The <code>tar</code> command is a one-stop shop for creating, extracting, and viewing the contents of <code>tar</code> archives (called
tarballs) whose usage is as follows:</p>
<ul>
<li>
<p>To <strong>create</strong> a tarball named <code>&lt;archive filename&gt;</code> containing <code>&lt;archive contents&gt;</code>, use the following command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@training $</span> tar -czvf &lt;archive filename&gt; &lt;archive contents&gt;
</pre></div>


<p>Where <code>&lt;archive filename&gt;</code> should end in <code>.tar.gz</code> and <code>&lt;archive contents&gt;</code> can be a list of any number of files
and/or folders, separated by spaces.</p>
</li>
<li>
<p>To <strong>extract</strong> the files from a tarball into the current directory:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@training $</span> tar -xzvf &lt;archive filename&gt;
</pre></div>


</li>
<li>
<p>To <strong>list</strong> the files within a tarball:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@training $</span> tar -tzvf &lt;archive filename&gt;
</pre></div>


</li>
</ul>
<p>Using the above knowledge, log into <code>learn.chtc.wisc.edu</code>, create a tarball that contains today's exercise 4.1
directory, and verify that it contains all the proper files.</p>
<h3 id="comparing-compressed-sizes">Comparing compressed sizes<a class="headerlink" href="#comparing-compressed-sizes" title="Permanent link">&para;</a></h3>
<p>You can adjust the level of compression of <code>tar</code> by prepending your command with <code>GZIP=--&lt;COMPRESSION&gt;</code>, where
<code>&lt;COMPRESSION&gt;</code> can be either <code>fast</code> for the least compression, or <code>best</code> for the most compression (the default
compression is between <code>best</code> and <code>fast</code>).</p>
<ol>
<li>Use <code>wget</code> to download the following files from our web server:<ol>
<li>Text file: <a href="http://proxy.chtc.wisc.edu/SQUID/osgschool19/random_text">http://proxy.chtc.wisc.edu/SQUID/osgschool19/random_text</a></li>
<li>Archive: <a href="http://proxy.chtc.wisc.edu/SQUID/osgschool19/pdbaa.tar.gz">http://proxy.chtc.wisc.edu/SQUID/osgschool19/pdbaa.tar.gz</a></li>
<li>Image: <a href="http://proxy.chtc.wisc.edu/SQUID/osgschool19/obligatory_cat.jpg">http://proxy.chtc.wisc.edu/SQUID/osgschool19/obligatory_cat.jpg</a></li>
</ol>
</li>
<li>Use <code>tar</code> on each file and use <code>ls -l</code> to compare the sizes of the original file and the compressed version.</li>
</ol>
<p>Which files were compressed the least? Why?</p>
<h2 id="transferring-files">Transferring files<a class="headerlink" href="#transferring-files" title="Permanent link">&para;</a></h2>
<h3 id="using-secure-copy">Using secure copy<a class="headerlink" href="#using-secure-copy" title="Permanent link">&para;</a></h3>
<p><a href="https://en.wikipedia.org/wiki/Secure_copy">Secure copy</a> (<code>scp</code>) is a command based on <code>SSH</code> that lets you securely copy
files between two different hosts.
It takes similar arguments to the <code>cp</code> command that you are familiar with but also takes additional host information:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@learn $</span> scp &lt;<span class="nb">source</span> <span class="m">1</span>&gt; &lt;<span class="nb">source</span> <span class="m">2</span>&gt;...&lt;<span class="nb">source</span> N&gt; &lt;remote host&gt;:&lt;remote path&gt;
</pre></div>


<p>For example, if I were logged in to <code>learn.chtc.wisc.edu</code> and wanted to copy the file <code>foo</code> from my current directory to
my local scratch directory on <code>training.osgconnect.net</code>, the command would look like this:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@learn $</span> scp foo training.osgconnect.net:/local-scratch/&lt;USERNAME&gt;/
</pre></div>


<p>Additionally, I could also pull files from <code>training.osgconnect.net</code> to <code>learn.chtc.wisc.edu</code>.
The following command copies <code>bar</code> from my local scratch directory on <code>training.osgconnect.net</code> to my current directory
on <code>learn.chtc.wisc.edu</code>:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@learn $</span> scp training.osgconnect.net:/local-scratch/&lt;USERNAME&gt;/bar .
</pre></div>


<p>You can also copy folders between hosts using the <code>-r</code> option.
If I kept all my files from Monday's exercise 1.3 in a folder named <code>monday-1.3</code> on <code>learn.chtc.wisc.edu</code>, I could use
the following command to copy them to my local scratch directory on <code>training.osgconnect.net</code>:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@learn $</span> scp -r monday-1.3 training.osgconnect.net:/local-scratch/&lt;USERNAME&gt;/
</pre></div>


<p>Try copying the tarball you created earlier in this exercise on <code>learn.chtc.wisc.edu</code> to <code>training.osgconnect.net</code>.</p>
<h3 id="secure-copy-from-your-laptop">Secure copy from your laptop<a class="headerlink" href="#secure-copy-from-your-laptop" title="Permanent link">&para;</a></h3>
<p>During your research, you may need to retrieve output files from your submit host to inspect them on your personal
machine, which can also be done with <code>scp</code>! To use <code>scp</code> on your laptop, follow the instructions relevant to your
machine's operating system:</p>
<h4 id="mac-and-linux-users">Mac and Linux users<a class="headerlink" href="#mac-and-linux-users" title="Permanent link">&para;</a></h4>
<p><code>scp</code> should be included by default and available via the terminal on both Mac and Linux operating systems.
Open a terminal window on your laptop and try copying the tarball containing today's exercise 4.1 from
<code>training.osgconnect.net</code> to your laptop.</p>
<h4 id="windows-users">Windows users<a class="headerlink" href="#windows-users" title="Permanent link">&para;</a></h4>
<p>WinSCP is an <code>scp</code> client for Windows operating systems.</p>
<ol>
<li>Install WinSCP from <a href="https://winscp.net/eng/index.php">https://winscp.net/eng/index.php</a></li>
<li>Start WinSCP and enter your SSH credentials for <code>training.osgconnect.net</code></li>
<li>Copy the tarball containing today's exercise 4.1 to your laptop</li>
</ol>
<h3 id="extra-challenge-using-rsync">Extra challenge: Using rsync<a class="headerlink" href="#extra-challenge-using-rsync" title="Permanent link">&para;</a></h3>
<p><code>scp</code> is a great, ubiquitous tool for one-time transfers but there are better tools if you find yourself transferring
the same set of files to the same location repeatedly.
Another common tool available on many Linux machines is <code>rsync</code>, which is like a beefed-up version of <code>scp</code>.
The invocation is similar to <code>scp</code>: you can transfer files and/or folders, but the options are different and when
transferring folders, make sure they don't have a trailing slash (<code>/</code>, this means to copy all the files within the
folder instead of the folder itself):</p>
<div class="codehilite"><pre><span></span><span class="gp">user@learn $</span> rsync -Pavz &lt;<span class="nb">source</span> <span class="m">1</span>&gt; &lt;<span class="nb">source</span> <span class="m">2</span>&gt;...&lt;<span class="nb">source</span> N&gt; &lt;remote host&gt;:&lt;remote path&gt;
</pre></div>


<p><code>rsync</code> has many benefits over <code>scp</code> but two of its biggest features are built-in compression (so you don't have to
create a tarball) and the ability to only transfer files that have changed.
Both of these feature are helpful when you're having connectivity issues so that you don't have to restart the transfer
from scratch every time your connection fails.</p>
<ol>
<li>Use <code>rsync</code> to transfer the folder containing today's exercise 1.1 to <code>training.osgconnect.net</code></li>
<li>
<p>Create a new file in your exercise 1.1 folder on <code>learn.chtc.wisc.edu</code> with the <code>touch</code> command:</p>
<div class="codehilite"><pre><span></span><span class="gp">user@learn $</span> touch &lt;filename&gt;
</pre></div>


</li>
<li>
<p>Use the same <code>rsync</code> command to transfer the folder with the new file you just created.
   How many files were transferred the first time? How many files were transferred if you run the same rsync command
   again?</p>
</li>
</ol>
<h2 id="next-exercise">Next exercise<a class="headerlink" href="#next-exercise" title="Permanent link">&para;</a></h2>
<p>Once completed, move onto the next exercise: <a href="../part4-ex3-submit-osg/">Running jobs in the OSG</a></p>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../part4-ex3-submit-osg/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../part4-ex3-submit-osg/" class="btn btn-xs btn-link">
        Exercise 4.3
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../part4-ex1-submit-refresher/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../part4-ex1-submit-refresher/" class="btn btn-xs btn-link">
        Exercise 4.1
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>